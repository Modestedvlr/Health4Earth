---
title: "Analyse par capitale â€” HEALTH4EARTH"
format: html
---

# ğŸ™ï¸ Analyse interactive par capitale

```{=html}
<div>
  <label for="capital">Choisir une capitale :</label>
  <select id="capital"></select>
</div>

<div id="charts"></div>

<script src="https://cdn.plot.ly/plotly-latest.min.js"></script>

<script>
// Charger les donnÃ©es capitales
fetch("data/series_capitales.json")
  .then(r => r.json())
  .then(data => {
    const select = document.getElementById("capital");

    // Remplir le sÃ©lecteur
    Object.keys(data).forEach(cap => {
      const opt = document.createElement("option");
      opt.value = cap;
      opt.textContent = cap;
      select.appendChild(opt);
    });

    // Fonction de rendu des graphiques
    function renderCharts(cap) {
      const series = data[cap].series;

      const years = series.map(d => d.year);
      const co2 = series.map(d => d.co2);
      const pollution = series.map(d => d.pollution);
      const life = series.map(d => d.life);

      const traces = [
        {
          x: years, y: co2, name: "COâ‚‚ (t/hab)", type: "scatter", mode: "lines+markers", line: {color: "#1f77b4"}
        },
        {
          x: years, y: pollution, name: "Pollution (dÃ©cÃ¨s/100k)", type: "scatter", mode: "lines+markers", line: {color: "#d62728"}
        },
        {
          x: years, y: life, name: "EspÃ©rance de vie", type: "scatter", mode: "lines+markers", line: {color: "#2ca02c"}
        }
      ];

      const layout = {
        title: `Indicateurs pour ${cap}`,
        xaxis: {title: "AnnÃ©e"},
        yaxis: {title: "Valeur"},
        legend: {orientation: "h"}
      };

      Plotly.newPlot("charts", traces, layout);
    }

    // Rendu initial
    renderCharts(select.value);

    // Changement de capitale
    select.addEventListener("change", e => {
      renderCharts(e.target.value);
    });
  });
</script>
