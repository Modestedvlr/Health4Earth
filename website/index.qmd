---
title: "Health4Earth Dashboard"
subtitle: "Analyse d'Impact & Prédictions 2030"
format: 
  html:
    theme: cosmo
    toc: true
    code-fold: true
jupyter: python3
---

## Objectif du Projet

Ce tableau de bord analyse l'impact des émissions industrielles sur la santé publique mondiale.
Il intègre un module d'**Intelligence Artificielle** (Régression Linéaire) pour anticiper les tendances jusqu'en 2030.

```{python}
#| label: setup
#| echo: false
#| warning: false

import pandas as pd
import matplotlib.pyplot as plt
import seaborn as sns

# Configuration Graphique
sns.set_theme(style="whitegrid")
plt.rcParams['figure.figsize'] = [11, 6]

# Import du package Health4Earth
from health4earth.data_ingest import load_merged_data
from health4earth.analytics import HealthAnalyzer

# Chargement du "Super-Dataset"
df = load_merged_data()
analyzer = HealthAnalyzer(df)
```


## Corrélation : Pollution vs Espérance de Vie
L'analyse croisée des données (Sources: OWID & IHME) révèle les inégalités face à la pollution.

```{python}
#| label: correlation-plot
#| fig-cap: "Impact de la pollution de l'air sur la mortalité (2019)"

# On prend une année récente avec des données complètes
df_focus = df[df['year'] == 2019].dropna(subset=['pollution_deaths', 'life_expectancy'])

plt.figure(figsize=(10, 6))
sns.scatterplot(
    data=df_focus, 
    x="life_expectancy", 
    y="pollution_deaths", 
    size="population", 
    sizes=(20, 1000), 
    hue="life_expectancy",
    palette="RdYlGn",
    alpha=0.7,
    legend=False
)
plt.title("Mortalité due à la pollution vs Espérance de Vie")
plt.xlabel("Espérance de vie (Années)")
plt.ylabel("Décès liés à la pollution (Total)")
plt.yscale('log')
plt.grid(True, which="both", ls="--", alpha=0.3)
plt.show()
```



## Intelligence Artificielle : Prédictions 2030
Nous utilisons le module scikit-learn pour projeter les tendances historiques de la France.

### Trajectoire Carbone (CO₂) 

La France respectera-t-elle ses objectifs de réduction ?

```{python}
#| label: predict-co2
#| warning: false

# Prédiction ML
df_pred_co2 = analyzer.predict_evolution("France", "co2", year_horizon=2030)

if df_pred_co2 is not None:
    plt.figure(figsize=(12, 5))
    
    # Zone historique
    sns.lineplot(data=df_pred_co2[df_pred_co2['type']=='Historique'], x='year', y='co2', label='Données Réelles', color='#1f77b4', linewidth=2.5)
    
    # Zone prédiction
    sns.lineplot(data=df_pred_co2[df_pred_co2['type']=='Prédiction'], x='year', y='co2', label='Projection IA (2030)', color='#d62728', linestyle='--', linewidth=2.5)
    
    plt.title("France : Trajectoire des émissions de CO2")
    plt.ylabel("CO2 (Millions de tonnes)")
    plt.axvline(x=2024, color='gray', linestyle=':')
    plt.legend()
    plt.show()
```



### Impact sur l'Espérance de Vie

Quel impact ces changements environnementaux auront-ils sur la santé ?

```{python}
#| label: predict-life
#| warning: false

df_pred_life = analyzer.predict_evolution("France", "life_expectancy", year_horizon=2030)

if df_pred_life is not None:
    plt.figure(figsize=(12, 5))
    sns.lineplot(data=df_pred_life, x='year', y='life_expectancy', hue='type', palette={'Historique': 'green', 'Prédiction': 'orange'}, linewidth=2.5)
    plt.title("France : Projection de l'Espérance de Vie")
    plt.ylabel("Années")
    plt.show()
```

## Conclusion :
Ce modèle montre que malgré une tendance à la baisse des émissions de CO₂ en France, l'impact sur la santé publique reste un enjeu majeur. La continuité des efforts écologiques est essentielle pour maintenir la courbe d'espérance de vie à la hausse.