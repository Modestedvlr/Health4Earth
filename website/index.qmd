---
title: "Health4Earth Dashboard"
subtitle: "Analyse d'Impact & Prédictions 2030"
format: 
  html:
    theme: cosmo
    toc: true
    code-fold: true
jupyter: python3
---

## Objectif du Projet

Ce tableau de bord interactif permet de visualiser l'impact des émissions de CO₂ sur la santé publique mondiale et de **projeter ces tendances jusqu'en 2030** grâce à des algorithmes d'apprentissage automatique (Machine Learning).

```{python}
#| label: setup
#| echo: false
#| warning: false

import sys
import os
import pandas as pd
import matplotlib.pyplot as plt
import seaborn as sns
import numpy as np

# Configuration Graphique
sns.set_theme(style="whitegrid")
plt.rcParams['figure.figsize'] = [12, 6]

# Import du package
from health4earth.data_ingest import load_merged_data
from health4earth.analytics import HealthAnalyzer

# Chargement des données
df = load_merged_data()
analyzer = HealthAnalyzer(df)
```


## Corrélation Globale : CO₂ vs Santé

Existe-t-il un lien visible entre la pollution industrielle et l'espérance de vie ?

```{python}
#| label: correlation-plot
#| fig-cap: "Relation entre CO2 et Mortalité liée à la pollution (2020)"

df_2020 = df[df['year'] == 2020].dropna()

plt.figure(figsize=(10, 6))
sns.scatterplot(
    data=df_2020, 
    x="co2", 
    y="pollution_deaths", 
    size="population", 
    sizes=(20, 500), 
    hue="life_expectancy",
    palette="viridis",
    alpha=0.7
)
plt.xscale('log')
plt.yscale('log')
plt.title("Impact du CO2 sur la mortalité (Échelle Logarithmique)")
plt.xlabel("Émissions de CO2 (Log)")
plt.ylabel("Décès liés à la pollution (Log)")
plt.legend(bbox_to_anchor=(1.05, 1), loc=2, borderaxespad=0., title="Espérance de Vie")
plt.show()
```



## Focus France : Prédictions 2030

Nous utilisons un modèle de Régression Linéaire (Scikit-Learn) entraîné sur les données historiques (2000-2024) pour prédire les tendances futures.

### Évolution du CO₂

La France respectera-t-elle ses objectifs de réduction ?

```{python}
#| label: predict-co2
#| warning: false

# Appel de la méthode de prédiction (Machine Learning)
df_pred_co2 = analyzer.predict_evolution("France", "co2", year_horizon=2030)

if df_pred_co2 is not None:
    plt.figure(figsize=(12, 5))
    
    # Historique
    sns.lineplot(data=df_pred_co2[df_pred_co2['type']=='Historique'], x='year', y='co2', label='Historique', color='blue', linewidth=2)
    
    # Prédiction
    sns.lineplot(data=df_pred_co2[df_pred_co2['type']=='Prédiction'], x='year', y='co2', label='Prédiction IA (2030)', color='red', linestyle='--', linewidth=2)
    
    plt.title("Prédiction des émissions de CO2 en France (Horizon 2030)")
    plt.ylabel("CO2 (Millions de tonnes)")
    plt.axvline(x=2024, color='gray', alpha=0.5, linestyle=':')
    plt.fill_between(df_pred_co2['year'], df_pred_co2['co2'] - 10, df_pred_co2['co2'] + 10, color='red', alpha=0.1)
    plt.show()
else:
    print("Pas assez de données pour la prédiction.")
```



### Impact sur l'Espérance de Vie

Quel impact ces changements environnementaux auront-ils sur la santé ?

```{python}
#| label: predict-life
#| warning: false

df_pred_life = analyzer.predict_evolution("France", "life_expectancy", year_horizon=2030)

if df_pred_life is not None:
    plt.figure(figsize=(12, 5))
    
    sns.lineplot(data=df_pred_life, x='year', y='life_expectancy', hue='type', palette={'Historique': 'green', 'Prédiction': 'orange'}, linewidth=2.5)
    
    plt.title("Projection de l'Espérance de Vie en France")
    plt.ylabel("Années")
    plt.show()
```

## Conclusion :
Ce modèle montre que malgré une tendance à la baisse des émissions de CO₂ en France, l'impact sur la santé publique reste un enjeu majeur. La continuité des efforts écologiques est essentielle pour maintenir la courbe d'espérance de vie à la hausse.