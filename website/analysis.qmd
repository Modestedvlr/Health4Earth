---
title: "Analyse Exploratoire"
format:
  html:
    code-fold: true
    toc: true
jupyter: python3
---

Cette page détaille les relations statistiques entre l'environnement et la santé à l'échelle mondiale.

```{python}
#| echo: false
#| warning: false

import matplotlib.pyplot as plt
import seaborn as sns
from health4earth.data_ingest import load_merged_data

# Chargement des données
df = load_merged_data()
df_2020 = df[df['year'] == 2020].copy()

# Configuration graphique
sns.set_theme(style="whitegrid")
plt.rcParams['figure.figsize'] = [10, 6]
```

## 1. Développement vs Santé
Nous analysons ici le lien entre le développement industriel (approximé par les émissions de CO₂) et l'espérance de vie.

```{python}
#| label: co2-life
#| warning: false

plt.figure()
sns.scatterplot(
    data=df_2020, 
    x='co2', 
    y='life_expectancy', 
    hue='life_expectancy', 
    size='population', 
    sizes=(20, 500), 
    palette='viridis', 
    legend=False,
    alpha=0.8
)
plt.xscale('log')
plt.title("Espérance de vie selon les émissions de CO2 (2020)")
plt.xlabel("Émissions de CO2 (Échelle Log)")
plt.ylabel("Espérance de vie (Années)")
plt.grid(True, which="both", ls="--", alpha=0.3)
plt.show()
```

### Analyse et Interprétation :
Ce graphique révèle une courbe logarithmique typique.
* Phase 1 (Pays en développement) : Une faible augmentation des émissions (début d'industrialisation) est corrélée à un gain massif d'espérance de vie (accès à l'énergie, hôpitaux).
* Phase 2 (Pays développés) : Une fois un certain seuil atteint (env. 100 Mt), la courbe s'aplatit. Emettre plus de CO₂ ne garantit plus une meilleure santé, et peut même devenir contre-productif.


## Le Coût Humain de la Pollution
Quel est le lien direct entre les décès liés à la qualité de l'air et le niveau de vie ?

```{python}
#| label: pollution-death
#| warning: false

plt.figure()
sns.scatterplot(
    data=df_2020, 
    x='life_expectancy', 
    y='pollution_deaths', 
    hue='co2', 
    palette='rocket_r',
    size='population',
    sizes=(20, 500)
)
plt.yscale('log')
plt.title("Mortalité (Pollution) vs Espérance de Vie")
plt.xlabel("Espérance de Vie (Années)")
plt.ylabel("Décès liés à la pollution (Log)")
plt.legend(bbox_to_anchor=(1.05, 1), loc=2, borderaxespad=0., title="CO2")
plt.show()
```

### Analyse et Interprétation :
On observe un paradoxe :
* Les pays à faible espérance de vie subissent une forte mortalité due à la pollution intérieure (charbon, bois).
* Les pays à forte espérance de vie (à droite) voient leurs décès liés à la pollution stagner ou baisser, malgré de fortes émissions de CO₂ (points foncés), grâce à des réglementations strictes et des soins de santé avancés.


## 3. Annexe : Structure du Code
Le code Python utilisé pour générer ces analyses repose sur notre package health4earth. Voici la logique simplifiée :


```{python}
# 1. Chargement via le module data_ingest (Pooch)
df = load_merged_data()

# 2. Filtrage pour l'année 2020
df_2020 = df[df['year'] == 2020]

# 3. Génération via Seaborn
sns.scatterplot(
    data=df_2020, 
    x='co2', 
    y='life_expectancy', 
    hue='life_expectancy', 
    size='population', 
    sizes=(20, 500), 
    palette='viridis', 
    legend=False,
    alpha=0.8)
```